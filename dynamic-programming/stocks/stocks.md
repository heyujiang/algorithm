### 股票买卖问题：

#### leetcode上的股票交易问题：
- 121. 买卖股票的最佳时机	🟢
- 122. 买卖股票的最佳时机 II	🟠
- 123. 买卖股票的最佳时机 III	🔴
- 188. 买卖股票的最佳时机 IV	🔴
- 309. 最佳买卖股票时机含冷冻期	🟠
- 714. 买卖股票的最佳时机含手续费	🟠
- 剑指 Offer 63. 股票的最大利润	🟠

第一题只进行一次交易，相当于交易次数 k=1 ； 第二题不限制交易次数， 相当于 k = 正无穷； 第三题只进行2次交易，相当于 k=2；第四题制定交易次数K，k=K；剩下两个题是不限制次数，但是增加了额外条件，例如冷冻期和手续费；
####确定状态和选择：

    对于**选择**，每天可以有三种选择，买入、卖出、无操作，可以用buy、sell、rest表示三种选择。
    但也并不是每天都可以任意选择这三种选择，因为sell必须在buy之后，buy必须在sell之后。rest操作应该有两种状态，一种是buy之后的rest，一种是buy之后的rest。
    因为有交易次数的k的限制，就是说 buy 只能在k>0的前提下操作。
    
    
    这个问题的**状态**有三个，第一个是天数，第二个是最大允许交易的次数，第三是当前持有的状态，股票无非是持有不持有，buy之后就是持有，sell之后就是不持有，可以使用0表示持有，1表示不持有。
    
    可以使用一个三维数组指定几种状态的组合：dp[i][k][0 or 1]；
    0 <= i < n  ;  1 <= k <= K ;
    n为天数，大K为交易次数的上限，0和1代表是否持有股票；
    
```text
for 0 <= i < n :
    for 1 <= k <= K :
        for s in {0,1} : 
            dp[i][k][s] = max(buy,sell,rest) 
```
    例如：dp[3][2][0]表示第三天，手上没有持有股票，至今最多交易了两次。dp[4][2][1]表示在第四天，手上持有了股票，至今最多交易了2次。
    求的最终答案是 ： dp[n-1][K][0]，即最后一天，最多允许操作K次交易，最后不持有股票，最多获得多少利润。    


#### 思考状态转移
    完成了状态的穷举，开始思考每种状态有哪些选择，应该如何更新状态。
    
    只看持有状态的话，不持有状态下可以买进（buy）或者不操作（rest），买进的话就变成了持有状态，不做操作的话，仍保持不持有状态；持有状态下可以卖出（sell）和不操作（rest），卖出的话就变成了不持有状态，不做操作的话仍然是持有状态。
    完整的交易是买进卖出，所以只有有交易次数时才能买进。
    卖出之后利润增长，买进之后利润减少。
    
    故状态转移方程为：
    不持有时 ： dp[i][k][0] = max(dp[i-1][k][0],dp[i-1][k][1] + prices[i])
                            max(rest          ,sell)
    - rest ： 昨天没有，最大交易次数k，今天不操作，仍然不持有 ，最大交易次数为k； 
    - sell ： 昨天持有，最大次数为k，今天卖出了，变为不持有，最大交易次数仍然为k；因为卖出了，利润相较于昨天持有时增长了price[i] ;
                            
    持有时   ： dp[i][k][1] = max(dp[i-1][k][1],dp[i-1][k-1][0] - prices[i]) 
                            max(rest          ,buy)
    - rest ： 昨天持有，最大交易次数为k，今天不操作，仍然持有，最大交易次数为k；
    - buy  ： 昨天不持有，最大交易次数为 k - 1，今天买进，变为持有，最大交易次数为 k ；因为买进了，利润相较于昨天不持有是减少了prices[i]；
    
#### 确认base case：
    - dp[-1][...][0] = 0 : 因为i是从0开始的，所以i=-1时，意味着还没有开始，肯定不持有股票，这个时候利润为0；
    - dp[-1][...][1] = -∞ ： 还没有开始的时候，是不能持有股票的 。 又因为算法是计算一个最大值的，所以初始值设置为一个最小值，方便去最大值。
    - dp[...][0][0] = 0 : 因为 k 是从 1 开始的，所以 k = 0 意味着根本不允许交易，这个时候的利润肯定为0；
    - dp[...][0][1] = -∞ ：在不允许交易的情况下肯定是不能持有股票的。又因为算法是计算一个最大值的，所以初始值设置为一个最小值，方便去最大值。
    


#### 转移方程总结总结：
    base case ：
    dp[-1][...][0] = dp[...][0][0] = 0
    dp[-1][...][1] = dp[...][0][1] = -∞
    
    转移方程：
    dp[i][k][0] = max(dp[i-1][k][0],dp[i-1][k][1] + prices[i])
    dp[i][k][1] = max(dp[i-1][k][1],dp[i-1][k-1][0] - prices[i])